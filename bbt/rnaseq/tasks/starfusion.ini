[tool]
name = STAR_Fusion
image = docker pull trinityctat/starfusion
desc = STAR-Fusion is a component of the Trinity Cancer Transcriptome Analysis Toolkit (CTAT). STAR-Fusion uses the STAR aligner to identify candidate fusion transcripts supported by Illumina reads. STAR-Fusion further processes the output generated by the STAR aligner to map junction reads and spanning reads to a reference annotation set.
logo = star-fusion.png
version =  v1.10.0
source = https://github.com/STAR-Fusion/STAR-Fusion
baseCmd = STAR-Fusion

[runtime]
# 支持的字段是wdl的runtime支持的字段
# 以下是关于动态设置memory的技巧:
#  String? memory
#  Int memoryGb = 1 + ceil(size(indexFiles, "G") * 1.3)
#  select_first([memory, "~{memoryGb}G"])
docker = trinityctat/starfusion:1.9.1
memory = 32 GiB
cpu = 1
disks = 50 GiB
# 7 days
time_minutes = 10080

[cmd]
cmd = STAR-Fusion --CPU [CPU] --left_fq [left_fq] --right_fq [right_fq] -J [chimeric_junction] --genome_lib_dir [genome_lib_dir] --output_dir [output_dir] --FusionInspector [FusionInspector] [examine_coding_effect] [denovo_reconstruct] [other_args]

[参数属性说明]
type = 表参数类型，如字符串(str), 整数（int), 浮点数（float），布尔值（bool)
is_infile = 表示是否为输入文件，使用yes或no表示
is_outfile = 表示是否为输出文件，使用yes或no表示
input_dir = 表示是否为输入目录
out_dir = 表示是否为输出目录
require = 表示该参数是否必须,使用yes或no表示
prefix = 参数前缀名称, 例如 -i， --i，如果没有前缀，使用none表示
default = 表示默认值，如果写为none，表示无默认值, 对于bool参数，默认值为yes 或 no
value_candidates = A,B, ...使用逗号分隔每一个参数的候选值
desc = 参数帮助说明
name = 页面上展示的参数名
format = 对于输入输出文件的格式要求说明
multi_values = 表示该参数可以输入多个值,用空格分开，如"-bams file1 file2 file3", 用yes或no表示
multi_times = 表示该参数可以重复输入多次，如"-b v1 -b v2 -b v3", 用yes或no表示

[other_args]
type = str
is_infile = no
is_outfile = no
require = no
prefix = none
default = none
value_candidates = none
desc = other arguments, you could set any other argument with a string such as '-i x -j y'
name = other_parameters

[CPU]
type = int
is_infile = no
is_outfile = no
require = yes
prefix = --CPU
default = 8
value_candidates = none
desc = Number of threads to use
name = CPU
format = none

[left_fq]
type = str
is_infile = yes
is_outfile = no
require = no
prefix = --left_fq
default = none
value_candidates = none
desc = read1 fastq files, separate by white space
name = left_fq
format = .fastq, .fastq.gz, .fq, .fq.gz
multi_values = yes

[right_fq]
type = str
is_infile = yes
is_outfile = no
require = no
prefix = --right_fq
default = none
value_candidates = none
desc = read1 fastq files, separate by white space
name = right_fq
format = .fastq, .fastq.gz, .fq, .fq.gz
multi_values = yes

[chimeric_junction]
type = str
is_infile = yes
is_outfile = no
input_dir = no
out_dir = no
require = no
prefix = -J
default = none
value_candidates = none
desc = generated file called 'Chimeric.out.junction' by STAR alignment
name = chimeric_junction
format = .junction, .txt
multi_values = no
multi_times = no

[genome_lib_dir]
type = str
is_infile = no
is_outfile = no
input_dir = yes
out_dir = no
require = yes
prefix = --genome_lib_dir
default = none
value_candidates = none
desc = ctat_genome_lib_build_dir
name = genome_lib_dir
format = none
multi_values = no
multi_times = no

[output_dir]
type = str
is_infile = no
is_outfile = no
input_dir = no
out_dir = yes
require = yes
prefix = --output_dir
default = fusion
value_candidates = none
desc = output directory
name = sample
format = none
multi_values = no
multi_times = no

[FusionInspector]
type = str
is_infile = no
is_outfile = no
input_dir = no
out_dir = no
require = yes
prefix = --FusionInspector
default = inspect
value_candidates = inspect, validate
desc = FusionInspector that provides a more in-depth view of the evidence supporting the predicted fusions.
name = FusionInspector
format = none
multi_values = no
multi_times = no

[examine_coding_effect]
type = bool
is_infile = no
is_outfile = no
input_dir = no
out_dir = no
require = yes
prefix = --examine_coding_effect
default = yes
value_candidates = yes, no
desc = explore impact of fusions on coding sequences
name = examine_coding_effect
format = none
multi_values = no
multi_times = no

[denovo_reconstruct]
type = bool
is_infile = no
is_outfile = no
input_dir = no
out_dir = no
require = yes
prefix = --denovo_reconstruct
default = yes
value_candidates = yes, no
desc = attempt to reconstruct fusion transcripts using Trinity de novo assembly (requires --FusionInspector)
name = denovo_reconstruct
format = none
multi_values = no
multi_times = no

[outputs]
extract_fusion_reads = Array[File]  glob("${sample}/star-fusion.fusion_evidence_*.fq")
fusion_predictions = File "${sample}/star-fusion.fusion_predictions.tsv"
fusion_predictions_abridged = File "${sample}/star-fusion.fusion_predictions.abridged.tsv"
bam = File "${sample}/Aligned.out.bam"
star_log_final = File "${sample}/Log.final.out"
junction = File "${sample}/Chimeric.out.junction"
sj =  File "${sample}/SJ.out.tab"
fusion_inspector_validate_fusions_abridged = Array[File] glob("${sample}/FusionInspector-validate/finspector.FusionInspector.fusions.abridged.tsv")
fusion_inspector_validate_web = Array[File] glob("${sample}/FusionInspector-validate/finspector.fusion_inspector_web.html")
fusion_inspector_inspect_web = Array[File] glob("${sample}/FusionInspector-inspect/finspector.fusion_inspector_web.html")
fusion_inspector_inspect_fusions_abridged = Array[File] glob("${sample}/FusionInspector-inspect/finspector.FusionInspector.fusions.abridged.tsv")
